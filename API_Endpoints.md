Спецификация API (Backend Endpoints)1. Группа: Клиентский интерфейс (Telegram Bot)Эти эндпоинты обеспечивают взаимодействие клиента с системой через мессенджер.POST /api/v1/clients/auth: Авторизация или регистрация клиента по номеру телефона и telegram_id.GET /api/v1/services: Получение списка доступных услуг (название, цена, длительность).GET /api/v1/slots/available: Запрос свободных временных слотов для календаря на основе текущей загрузки.POST /api/v1/appointments: Создание новой записи клиентом. После успешного создания карточка автоматически появляется на канбан-доске в колонке «Новые».GET /api/v1/appointments/my: Просмотр истории и статуса своих текущих записей.2. Группа: Панель менеджера (Dashboard)Инструменты для управления записями в «один клик».GET /api/v1/dashboard/board: Получение всех активных записей для канбан-доски и календарной сетки (с фильтрацией по дате/филиалу).PATCH /api/v1/appointments/{id}/status: Основной эндпоинт для Drag-and-Drop. Изменяет статус записи (например, перемещение в «Выполнено») и инициирует автоматическое уведомление клиенту.PATCH /api/v1/appointments/{id}/reschedule: Изменение времени записи через календарь.POST /api/v1/appointments/manual: Ручное создание записи менеджером при входящем звонке.3. Группа: Системные и аналитические функцииPOST /api/v1/system/import: Пакетная загрузка существующей клиентской базы из CSV или Excel.GET /api/v1/system/reports: Получение простых KPI (количество новых заявок, % выполненных, повторные визиты).Real-time синхронизация (WebSockets)Для обеспечения «легкости» и скорости работы мы внедряем WebSocket-канал ws://api/v1/dashboard/updates.Механика: Как только клиент нажимает кнопку «Подтвердить запись» в Telegram, сервер отправляет сообщение через WebSocket. У менеджера в браузере новая карточка мгновенно «подлетает» на канбан-доску со звуковым уведомлением, не требуя обновления страницы.Архитектурные риски и улучшенияРискРешениеRace ConditionПри запросе слотов GET /slots/available система временно «бронирует» время на 5 минут, пока клиент в боте принимает решение.Дублирование данныхВалидация уникальности telegram_id и телефона при импорте базы, чтобы не создавать два профиля для одного клиента.Безопасность APIВсе запросы от панели менеджера должны сопровождаться токеном (JWT), а запросы от бота — проверяться на соответствие hash от Telegram.